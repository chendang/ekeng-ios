<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
		<title>E康购物网</title>
		<script src="../js/lib/rem.js"></script>
		<link href="../css/lib/iconfont/iconfont.css" rel="stylesheet">
		<link href="../css/lib/mui.min.css" rel="stylesheet">
		<link rel="stylesheet" href="../css/lib/swiper.min.css">
		<link rel="stylesheet" href="../css/lib/huimin.css" />
		<link href="../css/MallIndex.css" rel="stylesheet">
		<style>
			[v-cloak] {
				display: none;
			}
			
			#app {
				bottom: 48px;
			}
			
			a {
				color: #1B1B1B;
				text-decoration: none
			}
			
			body {
				line-height: 1.2;
			}
			
			.image-wrap {
				-webkit-box-shadow: inset 0 0 2px rgba(0, 0, 0, .7), inset 0 2px 0 rgba(255, 255, 255, .3), inset 0 -1px 0 rgba(0, 0, 0, .5), 0 1px 3px rgba(0, 0, 0, .4);
				-moz-box-shadow: inset 0 0 2px rgba(0, 0, 0, .7), inset 0 2px 0 rgba(255, 255, 255, .3), inset 0 -1px 0 rgba(0, 0, 0, .5), 0 1px 3px rgba(0, 0, 0, .4);
				box-shadow: inset 0 0 2px rgba(0, 0, 0, .7), inset 0 2px 0 rgba(255, 255, 255, .3), inset 0 -1px 0 rgba(0, 0, 0, .5), 0 1px 3px rgba(0, 0, 0, .4);
			}
			
			.text3D {
				color: #737373;
				text-shadow: 0px 1px 0px #e5e5ee;
			}
		</style>
	</head>

	<body>
		<div id="app">
			<header class="mui-bar mui-bar-nav" id="header">
				<div class="top-sch-box flex-col">
					<div class="centerflex">
						<i class="fdj iconfont icon-search"></i>
						<div class="sch-txt">三高风险套餐</div>
						<span class="shaomiao"><i class="iconfont icon-saoma"></i></span>
					</div>
				</div>
				<a class="btn" href="">
					<i class="iconfont icon-tixing"></i>
				</a>
				<a class="btn" href="shopcar.html">
					<i class="iconfont icon-cart"></i>
				</a>
			</header>

			<div id="main" class="mui-clearfix">
				<!-- 搜索层 -->
				<div class="pop-schwrap">
					<div class="ui-scrollview">
						<div class="mui-bar mui-bar-nav clone">
							<a class="btn btn-back" href="javascript:;"></a>
							<div class="top-sch-box flex-col">
								<div class="centerflex">
									<input class="sch-input mui-input-clear" type="text" name="" id="" placeholder="连衣裙就是你的女人味儿" />
								</div>
							</div>
							<a class="mui-btn mui-btn-primary sch-submit">搜索</a>
						</div>
						<div class="scroll-wrap">
							<div class="mui-scroll">
								<div class="sch-cont">
									<div class="section ui-border-b">
										<div class="tit"><i class="iconfont icon-hot"></i>热门搜索</div>
										<div class="tags">
											<span class="tag">外套</span><span class="tag">连衣裙</span><span class="tag">运动鞋</span><span class="tag">睡衣</span>
											<span class="tag actice">外套</span><span class="tag">连衣裙</span><span class="tag">运动鞋</span><span class="tag">睡衣</span>
											<span class="tag">外套</span><span class="tag actice">连衣裙</span><span class="tag">运动鞋</span>
										</div>
									</div>
									<div class="section">
										<div class="tit"><i class="iconfont icon-time"></i>最近搜索</div>
										<div class="tags">
											<span class="tag">外套</span><span class="tag">连衣裙</span><span class="tag">运动鞋</span><span class="tag">睡衣</span>
											<span class="tag">外套</span><span class="tag">连衣裙</span><span class="tag">运动鞋</span><span class="tag">睡衣</span>
											<span class="tag">外套</span><span class="tag">连衣裙</span><span class="tag">运动鞋</span>
										</div>
									</div>
								</div>
								<div class="sch-clear">
									<a href="javascript:void"><i class="iconfont icon-shanchu"></i>清除搜索历史</a>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="mui-content">
					<div class="swiper_img">
						<div class="swiper-container">
							<div class="swiper-wrapper" style="height: 150px;">
								<div class="swiper-slide" v-for="(Item,index) in Ad1List" v-cloak>
									<img :src="Item.Ad1_img_url" alt="" width="100%" height="150px">
								</div>

							</div>
							<!-- Add Pagination -->
							<div class="swiper-pagination"></div>
						</div>
					</div>

					<div class="aui-list t-line" v-for="(Item,index) in ItemList" v-cloak>
						<h2 class="text3D">{{Item.ClassName}}</h2>
						<div @click="GoProductList(Item.ClassId)">
							<img :src="Item.img_url" width="100%" class="image-wrap">
						</div>
						<ul class="mui-table-view mui-grid-view" v-if="Item.ChildList.length>0">
							<li class="mui-table-view-cell mui-media mui-col-xs-4" v-for="xItem in Item.ChildList" v-cloak>
								<a @click="GoProductList(xItem.xClassId)">
									<img class="mui-media-object" :src="xItem.ximg_url">
									<div class="mui-media-body">{{xItem.xClassName}}</div>
								</a>
							</li>

						</ul>

						<div class="devider t-line"></div>
					</div>

				</div>
				<!--mui-content end-->
			</div>
		</div>

		<div style="height:50px;"></div>
		<div id="hui-footer" style="box-sizing:content-box;">
			<a href="../index.html" id="nav-home">
				<div class="hui-footer-icons hui-icons-home"></div>
				<div class="hui-footer-text">首页</div>
			</a>
			<a href="ShopCar.html" id="nav-news">
				<div class="hui-footer-icons hui-icons-shopping-cart"></div>
				<div class="hui-footer-text">购物车</div>
			</a>

			<a href="ProductClass.html" id="nav-forum" style="color: #ff395c;">
				<div class="hui-footer-icons hui-icons-forum"></div>
				<div class="hui-footer-text">分类</div>
			</a>
			<a href="../member/Person.html" id="nav-my">
				<div class="hui-footer-icons hui-icons-my"></div>
				<div class="hui-footer-text">我的</div>
			</a>
		</div>
	</body>
	<script type="text/javascript" src="../js/lib/jquery-2.1.3.min.js"></script>
	<script src="../js/lib/fastclick.js"></script>

	<script type="text/javascript" src="../js/hmt.js"></script>
	<script src="../js/public.js" type="text/javascript"></script>
	<script src="../js/swiper.min.js"></script>
	<script src="../js/base.js"></script>
	<script src="../js/lib/mui.min.js"></script>
	<script src="../js/lib/hui.js" type="text/javascript"></script>
	<script src="../js/lib/vue20.min.js" type="text/javascript"></script>
	<script src="../js/lib/axios.min.js"></script>
	<script src="../js/lib/qs.js"></script>
	<script>
		$(function() {

			$('.top-sch-box .fdj,.top-sch-box .sch-txt,.pop-schwrap .btn-back').on('click', function() {
				$('html,body').toggleClass('holding');
				$('.pop-schwrap').toggleClass('on');
				if($('.pop-schwrap').hasClass('on')) {;
					$('.pop-schwrap .sch-input').focus();
				}
			});

		});
	</script>
	<script type="text/javascript">
		var domainUrl = GetMallApiDomain();
		var ImageUrl = GetMallImage();

		vum = new Vue({
			el: '#app',

			data: {
				Ad1List: [],
				ItemList: []
			},
			mounted: function() {

				this.$nextTick(function() {

					this.GetAdList();
					this.GetClassList(0, 2);

					that = this;
					setTimeout(function() {
						that.MySwiper();
					}, 200);
				})

			},

			//				updated() {
			//							this.MySwiper();
			//				},

			methods: {

				GetClassList: function(parent_id, channel_id) {
					var that = this;
					that.axiosGetLoadding();
					axios.get(domainUrl + 'api/Product/getProductAllClass', {
							params: {
								parent_id: parent_id,
								channel_id: channel_id,
							}
						})
						.then(function(response) {
							var jsonx = eval(response.data);
							that.ItemList = [];

							each(jsonx, function(i, j) {

								var ChildList = [];
								each(j.childList, function(m, n) {
									ChildList.push({
										number: (m + 1),
										xClassId: n.xClassId,
										xClassName: n.xClassName,
										ximg_url: ImageUrl + n.ximg_url
									});
								});

								that.ItemList.push({
									number: (i + 1),
									ClassId: j.ClassId,
									ClassName: j.ClassName,
									img_url: (ImageUrl + j.img_url),
									ChildList: ChildList,
								});

							});

						})
						.catch(function(response) {
							console.log(response);

						});
				},

				GetAdList: function() {
					var that = this;
					that.axiosGetLoadding();
					axios.get(domainUrl + 'api/News/getIndexAdList', {
							params: {
								pageIndex: 1,
								strWhere: ' 1=1',
								filedOrder: 'id',
							}
						})
						.then(function(response) {
							var jsonx1 = eval(response.data.Ad1RecordList);
							that.Ad1List = [];
							each(jsonx1, function(i, j) {

								that.Ad1List.push({
									number: (i + 1),
									Ad1_Id: j.Ad1_Id,
									Ad1_Title: j.Ad1_Title,
									Ad1_link_url: j.Ad1_link_url,
									Ad1_img_url: ImageUrl + j.Ad1_img_url
								});

							});

						})
						.catch(function(response) {
							console.log(response);

						});
				},

				axiosGetLoadding: function() {
					axios.interceptors.request.use(function(config) {
						console.log('开始请求')
						config.headers['Content-Type'] = 'application/x-www-form-urlencoded';
						hui.loading('数据加载中');
						return config
					}, function(error) {
						console.log('请求失败')
						hui.closeLoading();
						hui.toast("数据加载失败,请检查网络");
						return Promise.reject(error)
					})
					axios.interceptors.response.use(function(config) {
						hui.closeLoading();

						console.log('接收响应')
						return config
					}, function(error) {
						console.log('响应出错')
						hui.closeLoading();
						hui.toast("数据加载失败,请检查网络");
						return Promise.reject(error)
					})
				},

				MySwiper: function() {
					var mySwiper = new Swiper('.swiper-container', {
						autoplay: 2000, //可选选项，自动滑动
						//分页器
						pagination: '.swiper-pagination',
						paginationClickable: true,
						observer: true
					})

				},
				GoProductList: function(ClassId) {
					location.href = "ProductList.html?ClassId=" + ClassId;

				}

			}

		})
	</script>

</html>