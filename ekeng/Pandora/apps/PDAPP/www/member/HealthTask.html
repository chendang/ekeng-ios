<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>8S管理日志</title>
		<meta name="viewport" content="initial-scale=1, maximum-scale=1">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../css/sm.min.css">
		<link rel="stylesheet" href="../css/Monitor.css">
		<link rel="stylesheet" href="../css/calendar.css">
		<link rel="stylesheet" href="../css/lib/huimin.css">

		<link rel="stylesheet" href="../css/task_mode2.css" type="text/css" >
		<link type="text/css" href="../css/style.css" rel="stylesheet" />
		<style>
			[v-cloak] {
				display: none;
			}
			
						
			.circle {
				display: block;
				float: left;
				padding: 1px;
				margin-left: 2px;
				width: 22%;
			}
			.circles-text {
				
				margin-top: -4px;

			}
			
			.tips-text {
				
				margin-top: -34px;
				margin-left: 16px;

			}
			
			.tips-text-three {
				
				margin-top: -34px;
				margin-left: 10px;

			}
			
			.weather {
    background: url(../img/5-01.jpg) no-repeat 0 -50px;
    background-size: 100% auto !important;
    padding: 10px 20px 30px;
}


.weather .p_info00 p {
    font-size: 18px;
    line-height: 12px;
    color: #fff;
    padding-top: 0px;
    margin-top: -5px;
}

.weather .p_info01 {
    text-align: right;
    color: #fff;
    line-height: 70px;
}
.weather .p_info02 p {
    font-size: 21px;
    line-height: 20px;
    color: #fff;
    padding-top: 0px;
}
.weather .p_info03 p {
	text-align: right;
    font-size: 21px;
    line-height: 20px;
    color: #fff;
    margin-top: -40px;
}
.more-white{
	color: #ffffff;
    font-size: 0.7rem;
    width: 55%;
    margin-left: 62%;
}



		</style>
	</head>

	<body>
		<div class="page-group" id="bodyinfo">
			<div class="page page-current">
				<header class="bar bar-nav">
					<a class="left bar-nav-mt1 back" onclick="CloseCurrentView();">
						<img src="../img/5-13.png" alt="">
					</a>
					<h2 class="title color-white">8S管理日志</h2>
			        
			       <!--<span class="title more-white" @click="TaskLog">记录</span>-->
				</header>

				<div class="content">
					<div class="databg">
						<div class="weather">
  <ul>
    <li class="p_info01" v-cloak>
      <i v-cloak>{{year}}年{{month}}月<br/>{{curweekday}}</i>
      <em v-cloak>{{day}}</em>
      <!--<em><img src="../img/5-20.png" alt="" /></em>-->
    </li>
    <li class="p_info00"><p v-cloak>{{insRecordTips}}</p></li>
    <!--<li class="p_info02"><p v-cloak>第{{TaskDays}}天</p></li>-->
    <li class="p_info02"><p @click="TaskLog">查看记录</p></li>
    <li class="p_info03"><p v-cloak @click="openMode">{{TaskTxt}}</p></li>
  </ul>
</div>
					</div>




    <!--健康计划start-->
    <div class="p_plan mt15" >

      <ul class="p_plan-list">

        
        <!--<li  @click="GoAnswerRecord">
          <div class="blist">
            <div class="m_cell_hd">

            </div>
            <div class="m_cell_hd  m_cell_primary" v-cloak>
              <h4>执行记录 <span style="color: #2EACD2;" v-cloak>({{takeState}})</span></h4>
             <p v-cloak>{{PushMsgTips}}</p>
            </div>
            <div class="m_cell_ft">
              	<div id="circles2"></div>
		                 <div class="tips-text">记录</div>
            </div>
          </div>
        </li>-->

        <li @click="GoFoodAdd">
          <div class="blist">
            <div class="m_cell_hd">

            </div>
            <div class="m_cell_hd  m_cell_primary" >
              <h4>膳食管理 <span style="color: #2EACD2;"></span></h4>
             <!--<p v-cloak>{{FoodTips}}</p>-->
             <p>记录您每天的膳食情况,我们的营养师为您制定合理的方案。</p>
            </div>
            <div class="m_cell_ft">
              	<div id="circles3"></div>
		                 <div class="tips-text">膳食</div>
            </div>
          </div>
        </li>
        
        <li @click="GoMedRecord">
          <div class="blist">
            <div class="m_cell_hd">

            </div>
            <div class="m_cell_hd  m_cell_primary">
              <h4>营养素管理 <span style="color: #2EACD2;"></span></h4>
             <!--<p v-cloak>{{MedTips}}</p>-->
             <p>每天请按时服用营养素哦！</p>
            </div>
            <div class="m_cell_ft">
              	<div id="circles4"></div>
		                 <div class="tips-text-three">营养素</div>
            </div>
          </div>
        </li>


        <li  @click="GoSleepAdd">
          <div class="blist">
            <div class="m_cell_hd">

            </div>
            <div class="m_cell_hd  m_cell_primary">
              <h4>睡眠管理记录 <span style="color: #2EACD2;"></span></h4>
             <!--<p v-cloak>{{insRecordTips}}</p>-->
             <p>请记录您的睡眠状态哦！</p>
            </div>
            <div class="m_cell_ft">
              	<div id="circles1"></div>
		                 <div class="tips-text">睡眠</div>
            </div>
          </div>
        </li>

       <li  @click="GoFeelingAdd">
          <div class="blist">
            <div class="m_cell_hd">

            </div>
            <div class="m_cell_hd  m_cell_primary">
              <h4>心情管理 <span style="color: #2EACD2;"></span></h4>
             <!--<p v-cloak>{{FeelingTips}}</p>-->
              <p>记录您今天的心情状态哦！</p>
            </div>
            <div class="m_cell_ft">
              	<div id="circles5"></div>
		                 <div class="tips-text">心情</div>
            </div>
          </div>
        </li>
        
               <li @click="GoSportPlan">
          <div class="blist">
            <div class="m_cell_hd">

            </div>
            <div class="m_cell_hd  m_cell_primary">
              <h4>运动管理 <span style="color: #2EACD2;"></span></h4>
             <!--<p v-cloak>{{SportTips}}</p>-->
             <p>您今天运动了没！</p>
            </div>
            <div class="m_cell_ft">
              	<div id="circles6"></div>
		                 <div class="tips-text">运动</div>
            </div>
          </div>
        </li>
        
        <li @click="GoAirHome">
          <div class="blist">
            <div class="m_cell_hd">

            </div>
            <div class="m_cell_hd  m_cell_primary">
              <h4>环境管理 <span style="color: #2EACD2;"></span></h4>
             <!--<p v-cloak>{{AirHomeTips}}</p>-->
             <p v-cloak>您生活环境状态比较重要哦！</p>
            </div>
            <div class="m_cell_ft">
              	<div id="circles7"></div>
		                 <div class="tips-text">环境</div>
            </div>
          </div>
        </li>
        
        
        <!--<li>
          <div class="blist">
            <div class="m_cell_hd">

            </div>
            <div class="m_cell_hd  m_cell_primary">
              <h4>健康培训 <span style="color: #2EACD2;">(待完成)</span></h4>
             <p v-cloak>{{AirHomeTips}}</p>
            </div>
            <div class="m_cell_ft">
              	<div id="circles8"></div>
		                 <div class="tips-text">培训</div>
            </div>
          </div>
        </li>-->
        
      </ul>
    </div>


	

				</div>

			</div>
			
			
	<!--弹窗start-->
    <div class="model_tasks">
        <div class="tasks">
            <!--<h3 v-cloak>第{{TaskDays}}天任务  <i class="i_task_close" @click="closeMode"></i></h3>-->
            <h3 v-cloak>今日任务  <i class="i_task_close" @click="closeMode"></i></h3>
            <div class="tasks_main">
                <ul class="ul_tasks">
                    <li v-for="(Item,index) in QuestionList" :class="{'disabled':Item.isdo==1}" v-cloak >
                        <h5>{{Item.PushContent}}</h5>
                        <div class="switch" :class="{'on':Item.isdo==0,'off':Item.isdo==1}" @click="switchOn(Item.PushId);">
                            <div><i></i></div>
                        </div>
                    </li>
                     <li v-show="isSleep">
                        <h5>昨晚睡眠记录</h5>
                        <p>昨晚睡眠怎么样，来，记录一下！</p>
                        <i class="i_go_recode" @click="GoSleepAdd();">去记录</i>
                    </li>
                   


                    <!--<li v-for="(Item,index) in MedAmList" :class="{'disabled':Item.isdo==1 || !isAM}" v-cloak>-->
                    <li v-for="(Item,index) in MedAmList" :class="{'disabled':Item.isdo==1}" v-cloak v-show="Item.isShow!=1">
                        <h5>营养素({{Item.TakeWay}})</h5>
                        <p>{{Item.PushContent}}</p>
                        <div class="switch" :class="{'on':Item.isdo==0,'off':Item.isdo==1}" @click="MedAmSwitchOn(Item.PushId,Item.TakeTime);">
                            <i></i>
                        </div>
                    </li>
                    
                    <li v-for="(Item,index) in SportAmList" :class="{'disabled':Item.isdo==1}" v-cloak v-show="Item.isShow!=1">
                        <h5>运动({{Item.TakeWay}})</h5>
                        <p>{{Item.PushContent}}</p>
                        <div class="switch" :class="{'on':Item.isdo==0,'off':Item.isdo==1}" @click="SportAmSwitchOn(Item.PushId,Item.TakeTime);">
                            <i></i>
                        </div>
                    </li>

                    <li v-for="(Item,index) in MedNmList" :class="{'disabled':Item.isdo==1}" v-cloak v-show="Item.isShow!=1">
                        <h5>营养素({{Item.TakeWay}})</h5>
                        <p>{{Item.PushContent}}</p>
                        <div class="switch" :class="{'on':Item.isdo==0,'off':Item.isdo==1}" @click="MedNmSwitchOn(Item.PushId,Item.TakeTime);">
                            <i></i>
                        </div>
                    </li>

                    <li v-for="(Item,index) in SportNmList" :class="{'disabled':Item.isdo==1}" v-cloak v-show="Item.isShow!=1">
                        <h5>运动({{Item.TakeWay}})</h5>
                        <p>{{Item.PushContent}}</p>
                        <div class="switch" :class="{'on':Item.isdo==0,'off':Item.isdo==1}" @click="SportNmSwitchOn(Item.PushId,Item.TakeTime);">
                            <i></i>
                        </div>
                    </li>

                     <li v-show="isRest">
                        <h5>午休睡眠记录</h5>
                        <p>午休睡了吗，来，记录一下！</p>
                        <i class="i_go_recode" @click="GoRestAdd();">去记录</i>
                    </li>
                    
                    <li v-for="(Item,index) in MedPmList" :class="{'disabled':Item.isdo==1}" v-cloak v-show="Item.isShow!=1">
                        <h5>营养素({{Item.TakeWay}})</h5>
                        <p>{{Item.PushContent}}</p>
                        <div class="switch" :class="{'on':Item.isdo==0,'off':Item.isdo==1}" @click="MedPmSwitchOn(Item.PushId,Item.TakeTime);">
                            <i></i>
                        </div>
                    </li>
                    
                     <li v-for="(Item,index) in SportPmList" :class="{'disabled':Item.isdo==1}" v-cloak v-show="Item.isShow!=1">
                        <h5>运动({{Item.TakeWay}})</h5>
                        <p>{{Item.PushContent}}</p>
                        <div class="switch" :class="{'on':Item.isdo==0,'off':Item.isdo==1}" @click="SportPmSwitchOn(Item.PushId,Item.TakeTime);">
                            <i></i>
                        </div>
                    </li>
                    
                    <li v-for="(Item,index) in MedEmList" :class="{'disabled':Item.isdo==1}" v-cloak v-show="Item.isShow!=1">
                        <h5>营养素({{Item.TakeWay}})</h5>
                        <p>{{Item.PushContent}}</p>
                        <div class="switch" :class="{'on':Item.isdo==0,'off':Item.isdo==1}" @click="MedEmSwitchOn(Item.PushId,Item.TakeTime);">
                            <i></i>
                        </div>
                    </li>
                    <li v-for="(Item,index) in SportEmList" :class="{'disabled':Item.isdo==1}" v-cloak v-show="Item.isShow!=1">
                        <h5>运动({{Item.TakeWay}})</h5>
                        <p>{{Item.PushContent}}</p>
                        <div class="switch" :class="{'on':Item.isdo==0,'off':Item.isdo==1}" @click="SportEmSwitchOn(Item.PushId,Item.TakeTime);">
                            <i></i>
                        </div>
                    </li>
                    <li v-for="(Item,index) in SportXmList" :class="{'disabled':Item.isdo==1}" v-cloak v-show="Item.isShow!=1">
                        <h5>运动({{Item.TakeWay}})</h5>
                        <p>{{Item.PushContent}}</p>
                        <div class="switch" :class="{'on':Item.isdo==0,'off':Item.isdo==1}" @click="SportXmSwitchOn(Item.PushId,Item.TakeTime);">
                            <i></i>
                        </div>
                    </li>
                    <!--<li>
                        <h5>运动记录</h5>
                        <p>云医生安排了特别的运动给您，运动一下吧！</p>
                        <i class="i_go_recode" @click="GoSportPlan();">去记录</i>
                    </li>-->
                    <li>
                        <h5>心情记录</h5>
                        <p>此刻的心情状态如何？......</p>
                        <i class="i_go_recode" @click="GoFeelingAdd();">去记录</i>
                    </li>
                    <li>
                        <h5>膳食记录</h5>
                        <p>今天用餐情况怎么样？记录一下吧！</p>
                        <i class="i_go_recode" @click="GoFoodAdd();">去记录</i>
                    </li>
                    <li>
                        <h5>健康问答</h5>
                        <p>涨知识啦！</p>
                        <i class="i_go_recode" @click="GoAnswer();">去回答</i>
                    </li>                   
                </ul>

                <div class="task_tips">建议晚上10点左右睡觉，最迟不要超过11点哦</div>
            </div>
        </div>
    </div>
			<!--弹窗end-->
			
			
		</div>
        <script src="../js/lib/jquery-2.1.3.min.js"></script>
		<script src="../js/lib/hui.js"></script>
		<script src="../js/base.js"></script>
<script src="../js/circles.js"></script>
<script src="../js/taskDataCircles.js"></script>
		<script src="../js/public.js" type="text/javascript"></script>
		<script src="../js/lib/vue20.min.js" type="text/javascript"></script>
		<script src="../js/lib/axios.min.js"></script>
		<script src="../js/lib/qs.js"></script>


<script>

            var child1 = document.getElementById('circles1');
//			var child2 = document.getElementById('circles2');
			var child3 = document.getElementById('circles3');
            var child4 = document.getElementById('circles4');
            var child5 = document.getElementById('circles5');
			var child6 = document.getElementById('circles6');
			var child7 = document.getElementById('circles7');
//          var child8 = document.getElementById('circles8');

        
		var domainUrl = GetMvcApiDomain();
		var FromUrl=null;
		var username = null;
        var daycode=null;
		var oldcode=null;	
		
		function plusReady() {
            daycode=getNowFormatDate();
            oldcode = plus.storage.getItem("daycode");
			var objuser = JSON.parse(plus.storage.getItem('user'));
			username = objuser.UserName;
			
			var _self = plus.webview.currentWebview();
			FromUrl = _self.FromUrl;
			
			back();
			
			
			
			
		}

		if(window.plus) {
			plusReady();
		} else {
			document.addEventListener("plusready", plusReady, false);
		}

		var UserRole = 1;
		var shopbm = "xt000001";
		var calendarVue = new Vue({
			el: '#bodyinfo',
			data: {
					year: '2018',
						month: "09",
						day: '01',
						curDate: "20180901",
						curweekday: '星期一',
						TaskDays:0,
				dialogShow: false,
				QuestionList: [],
				QuestionContent: '',
				QuestionId: 0,
				QuestionNum: 0,
				takeState: "待完成",
				
				MedAmList: [],
				MedNmList: [],
				MedPmList: [],
				MedEmList: [],
				
				SportAmList: [],
				SportNmList: [],
				SportPmList: [],
				SportEmList: [],
				SportXmList: [],
                
				insRecordTips: "没有监测记录",
				SignOnTips: "没有记录",
				PushMsgTips: "没有记录",
				FoodTips: "没有记录",
				MedTips: "没有记录",
				FeelingTips: "没有记录",
				SportTips: "没有记录",
				AirHomeTips: "没有记录",

                    SportVal: 0,
					FoodVal: 0,
					MedVal: 0,
					MonitorVal: 0,

				CreateUser: UserRole,
				ShopUser: shopbm,
				IsTask:-1,
				TaskTxt:'查看任务',
				FromUrl:FromUrl,
				ShowModeCount:0,
				isAM:true,
				isNM:true,
				isPM:true,
				isEM:true,
				isSleep:true,
				isRest:true

			},

			mounted: function() {

				this.$nextTick(function() {
					
                    this.getToDayDate();
                    this.getTaskConfig();
                    this.getIsSleepRecord(username)
                    this.getTaskDays(username);
					this.getInRecordInfo(username);
					this.GetDayRecordInfo(username);
					this.getTaskData(username);
					this.getDailyMedList();
					this.getDailySportList();

				})

			},
			methods: {
					getTaskConfig: function() {
						var that = this;
						that.axiosGetLoadding();
						axios.get(domainUrl + 'api/HealthTask/getTaskConfig', {
								params: {
									UserName: username,
								}
							})
							.then(function(response) {
								if(response.data.code='200'){

										that.IsTask=response.data.res;
										
									if (response.data.res==1){
											
										setTimeout(function () {
											
											if (that.FromUrl=='MsgTo' || oldcode==null || oldcode==undefined || oldcode=='' || oldcode!=daycode){
											plus.storage.setItem('daycode', daycode);
                                            that.openMode();
                                            
											//that.getDailyQuestionList(username, '1', '200');
											
                                           }
                                        }, 500);
                                        
                                            

										}
									else{
										that.TaskTxt='查看任务';
									}
									
									
								}
								else{
									that.IsTask=-1;
								}
								
							})
							.catch(function(response) {
								console.log(response);

							});

					},
					
					getIsSleepRecord: function(UserName) {

						var that = this;
						that.axiosGetLoadding();
						axios.get(domainUrl + 'api/Sleep/getMDaysSleepIsRecord', {
								params: {
									UserName: UserName,
								}
							})
							.then(function(response) {

								if(response.data.code == "200") {
                                   if (response.data.IsSleep==1){
                                   that.isSleep=false;
                                   }
                                   else{
                                   	that.isSleep=true;
                                   }
                                   
                                   if (response.data.IsRest==1){
                                   that.isRest=false;
                                   }
                                   else{
                                   	that.isRest=true;
                                   }
                                    

								}

							})

							.catch(function(response) {

								console.log(response);
							});

					},
					
					getServerTime: function() {

						var that = this;
						that.axiosGetLoadding();
						axios.get(domainUrl + 'api/Med/getServerDateTime', {
							})
							.then(function(response) {

								if(response.data.code == "200") {
                                   var curTime=response.data.serverTime;
                                   that.isAM=time_range("5:00", "10:30", curTime);
                                   that.isNM=time_range("11:00", "14:30", curTime);
                                   that.isPM=time_range("16:00", "19:30", curTime);
                                   that.isEM=time_range("20:00", "24:00", curTime);
                                   
                                    

								}

							})

							.catch(function(response) {
								that.IsShow = 0;
								console.log(response);
							});

					},
					getToDayDate: function() {
						var now = new Date();
						this.year = now.getFullYear(); //年
						this.month = now.getMonth() + 1; //月
						this.day = now.getDate(); //日

						if(this.month < 10)
							this.month = "0" + this.month;

						if(this.day < 10)
							this.day = "0" + this.day;

						this.curDate = this.year.toString() + this.month.toString() + this.day.toString()

						var myddy = now.getDay(); //获取存储当前日期
						var weekday = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"];
						this.curweekday = weekday[myddy];
					},

                  getTaskDays: function(UserName) {

						var that = this;
						that.axiosGetLoadding();
						axios.get(domainUrl + 'api/HealthTask/getTaskDays', {
								params: {
									UserName: UserName
								}
							})
							.then(function(response) {

								if(response.data.code == "200") {

                                 that.TaskDays=response.data.theDays;
 
								}

							})

							.catch(function(response) {

								console.log(response);
							});

					},
					AnswerMedQuestion: function(rescontent,QuestionId,UserName,num,TakeTime) {
					var that = this;
					if(rescontent == '' || rescontent == null) {
						hui.upToast('请确认答案哦');
						return false;
					}

					if(UserName == '' || UserName == null) {
						hui.upToast('请登录系统再回复哦');
						return false;
					}

					if(QuestionId == '' || QuestionId == null) {
						hui.upToast('读取资料失败,请刷新再试!');
						return false;
					}

					axios.post(domainUrl + 'api/Med/PostAnswerMedSave', Qs.stringify({
							UserName: UserName,
							QuestionId: QuestionId,
							ResContent: rescontent,
							TakeTime: TakeTime
						}))

						.then(function(response) {
							if(response.data.code == '200') {
								hui.upToast(response.data.msg);
								if(TakeTime=='AM'){
									that.MedAmList[num].isdo=1;
									setTimeout(function () {
                                        that.MedAmList[num].isShow=1;
                                    }, 2000);
								}
								if(TakeTime=='NM'){
									that.MedNmList[num].isdo=1;
									setTimeout(function () {
                                        that.MedNmList[num].isShow=1;
                                    },2000);
								}								
								if(TakeTime=='PM'){
									that.MedPmList[num].isdo=1;
									setTimeout(function () {
                                        that.MedPmList[num].isShow=1;
                                    },2000);
								}								
								if(TakeTime=='EM'){
									that.MedEmList[num].isdo=1;
									setTimeout(function () {
                                        that.MedEmList[num].isShow=1;
                                    },2000);
								}
							} else {
								hui.upToast(response.data.msg);
								return false;
							}

						})
						.catch(function(response) {
							console.log(response);
						});

				},
				
				AnswerSportQuestion: function(rescontent,QuestionId,UserName,num,TakeTime) {
					var that = this;
					if(rescontent == '' || rescontent == null) {
						hui.upToast('请确认答案哦');
						return false;
					}

					if(UserName == '' || UserName == null) {
						hui.upToast('请登录系统再回复哦');
						return false;
					}

					if(QuestionId == '' || QuestionId == null) {
						hui.upToast('读取资料失败,请刷新再试!');
						return false;
					}

					axios.post(domainUrl + 'api/Sport/PostAnswerSportSave', Qs.stringify({
							UserName: UserName,
							QuestionId: QuestionId,
							ResContent: rescontent,
							TakeTime: TakeTime
						}))

						.then(function(response) {
							if(response.data.code == '200') {
								hui.upToast(response.data.msg);
								if(TakeTime=='AM'){
								that.SportAmList[num].isdo=1;
								setTimeout(function () {
                                        that.SportAmList[num].isShow=1;
                                }, 300);
								}
								if(TakeTime=='NM'){
								that.SportNmList[num].isdo=1;
								setTimeout(function () {
                                        that.SportNmList[num].isShow=1;
                                }, 300);
								}
								if(TakeTime=='PM'){
								that.SportPmList[num].isdo=1;
								setTimeout(function () {
                                        that.SportPmList[num].isShow=1;
                                }, 300);
								}
								if(TakeTime=='EM'){
								that.SportEmList[num].isdo=1;
								setTimeout(function () {
                                        that.SportEmList[num].isShow=1;
                                }, 300);
								}
								if(TakeTime=='XM'){
								that.SportXmList[num].isdo=1;
								setTimeout(function () {
                                        that.SportXmList[num].isShow=1;
                                }, 300);
								}

							} else {
								hui.upToast(response.data.msg);
								return false;
							}

						})
						.catch(function(response) {
							console.log(response);
						});

				},
				
					getDailyQuestionList: function(UserName, pageIndex, pageSize) {
					var that = this;
	
					axios.get(domainUrl + 'api/PushMsg/getDailyPushMsgList', {
							params: {
								UserName: UserName,
								pageIndex: pageIndex,
								pageSize: pageSize,
							}
						})
						.then(function(response) {
							var jsonx = eval(response.data.RecordList);
							that.QuestionList = [];
							each(jsonx, function(i, j) {
								that.QuestionList.push({
									number: (i + 1),
									PushId: j.Id,
									PushContent: j.PushContent,
									isdo:j.isdo
								});

							});

						})
						.catch(function(response) {
							console.log(response);

						});

				},
				
				getDailyMedList: function() {
					var that = this;
	
					axios.get(domainUrl + 'api/Med/getDailyMedList', {
							params: {
								UserName: username,
								pageIndex: 1,
								pageSize: 200,
							}
						})
						.then(function(response) {
							var jsonx = eval(response.data.RecordList);
							that.MedAmList = [];
							that.MedNmList = [];
							that.MedPmList = [];
							that.MedEmList = [];
							each(jsonx, function(i, j) {
								var TakeWay="不限时";
								if (j.TakeTime=="AM"){
									TakeWay="早餐";
									that.MedAmList.push({
									number: (i + 1),
									PushId: j.Id,
									PushContent: j.PushContent,
									TakeTime: j.TakeTime,
									TakeWay: TakeWay,
									isdo:j.isdo,
									isShow:j.isdo
								});
								}
								if (j.TakeTime=="NM"){
									TakeWay="午餐";
									that.MedNmList.push({
									number: (i + 1),
									PushId: j.Id,
									PushContent: j.PushContent,
									TakeTime: j.TakeTime,
									TakeWay: TakeWay,
									isdo:j.isdo,
									isShow:j.isdo
								});
								}
								if (j.TakeTime=="PM"){
									TakeWay="晚餐";
									that.MedPmList.push({
									number: (i + 1),
									PushId: j.Id,
									PushContent: j.PushContent,
									TakeTime: j.TakeTime,
									TakeWay: TakeWay,
									isdo:j.isdo,
									isShow:j.isdo
								});
								}
								if (j.TakeTime=="EM"){
									TakeWay="睡前";
									that.MedEmList.push({
									number: (i + 1),
									PushId: j.Id,
									PushContent: j.PushContent,
									TakeTime: j.TakeTime,
									TakeWay: TakeWay,
									isdo:j.isdo,
									isShow:j.isdo
								});
								}


							});

						})
						.catch(function(response) {
							console.log(response);

						});

				},
				
				getDailySportList: function() {
					var that = this;
	
					axios.get(domainUrl + 'api/Sport/getDailySportList', {
							params: {
								UserName: username,
								pageIndex: 1,
								pageSize: 200,
							}
						})
						.then(function(response) {
							var jsonx = eval(response.data.RecordList);
							that.SportAmList = [];
							that.SportNmList = [];
                            that.SportPmList = [];
                            that.SportEmList = [];
                            that.SportXmList = [];
                
							each(jsonx, function(i, j) {
								var TakeWay="不限时";
								if (j.TakeTime=="AM"){
									TakeWay="早晨";
									that.SportAmList.push({
									number: (i + 1),
									PushId: j.Id,
									PushContent: j.PushContent,
									TakeTime: j.TakeTime,
									TakeWay: TakeWay,
									isdo:j.isdo,
									isShow:j.isdo
								});
								}
								if (j.TakeTime=="NM"){
									TakeWay="中午";
									that.SportNmList.push({
									number: (i + 1),
									PushId: j.Id,
									PushContent: j.PushContent,
									TakeTime: j.TakeTime,
									TakeWay: TakeWay,
									isdo:j.isdo,
									isShow:j.isdo
								});
								}
								if (j.TakeTime=="PM"){
									TakeWay="傍晚";
							        that.SportPmList.push({
									number: (i + 1),
									PushId: j.Id,
									PushContent: j.PushContent,
									TakeTime: j.TakeTime,
									TakeWay: TakeWay,
									isdo:j.isdo,
									isShow:j.isdo
								});
								}
								if (j.TakeTime=="EM"){
									TakeWay="睡前";
									that.SportEmList.push({
									number: (i + 1),
									PushId: j.Id,
									PushContent: j.PushContent,
									TakeTime: j.TakeTime,
									TakeWay: TakeWay,
									isdo:j.isdo,
									isShow:j.isdo
								});
								}
								if (j.TakeTime=="XM"){
									TakeWay="不限时";
									that.SportXmList.push({
									number: (i + 1),
									PushId: j.Id,
									PushContent: j.PushContent,
									TakeTime: j.TakeTime,
									TakeWay: TakeWay,
									isdo:j.isdo,
									isShow:j.isdo
								});
								}


							});

						})
						.catch(function(response) {
							console.log(response);

						});

				},
				

				openMode: function() {
					$(".model_tasks").fadeIn(500);
					this.ShowModeCount++;

				},
				closeMode: function() {
					$(".model_tasks").fadeOut();
				},
				switchOn: function(mid) {
					//hui.alert(mid);
					for(var i=0;i<this.QuestionList.length;i++){  
                       //alert(arr[i]);
                       if (this.QuestionList[i].PushId==mid){
                       	  if (this.QuestionList[i].isdo==0){
                       	  	this.AnswerQuestion('Take',mid,username,i,'SNS');
                       	  	//this.QuestionList[i].isdo=1;
                       	  }
                       	  else{
                       	  	
                       	  	//this.QuestionList[i].isdo=0;
                       	  }
                       }
                     } 

				},
			    MedAmSwitchOn: function(mid,TakeTime) {
					//hui.alert(mid);
					for(var i=0;i<this.MedAmList.length;i++){  
                       //alert(arr[i]);
                       if (this.MedAmList[i].PushId==mid){
                       	  if (this.MedAmList[i].isdo==0){
                       	  	this.AnswerMedQuestion('Take',mid,username,i,TakeTime);
                       	  	//this.QuestionList[i].isdo=1;
                       	  }
                       	  else{
                       	  	
                       	  	//this.QuestionList[i].isdo=0;
                       	  }
                       }
                     } 

				},
                MedNmSwitchOn: function(mid,TakeTime) {
					//hui.alert(mid);
					for(var i=0;i<this.MedNmList.length;i++){  
                       //alert(arr[i]);
                       if (this.MedNmList[i].PushId==mid){
                       	  if (this.MedNmList[i].isdo==0){
                       	  	this.AnswerMedQuestion('Take',mid,username,i,TakeTime);
                       	  	//this.QuestionList[i].isdo=1;
                       	  }
                       	  else{
                       	  	
                       	  	//this.QuestionList[i].isdo=0;
                       	  }
                       }
                     } 

				},	
				MedPmSwitchOn: function(mid,TakeTime) {
					//hui.alert(mid);
					for(var i=0;i<this.MedPmList.length;i++){  
                       //alert(arr[i]);
                       if (this.MedPmList[i].PushId==mid){
                       	  if (this.MedPmList[i].isdo==0){
                       	  	this.AnswerMedQuestion('Take',mid,username,i,TakeTime);
                       	  	//this.QuestionList[i].isdo=1;
                       	  }
                       	  else{
                       	  	
                       	  	//this.QuestionList[i].isdo=0;
                       	  }
                       }
                     } 

				},
				MedEmSwitchOn: function(mid,TakeTime) {
					//hui.alert(mid);
					for(var i=0;i<this.MedEmList.length;i++){  
                       //alert(arr[i]);
                       if (this.MedEmList[i].PushId==mid){
                       	  if (this.MedEmList[i].isdo==0){
                       	  	this.AnswerMedQuestion('Take',mid,username,i,TakeTime);
                       	  	//this.QuestionList[i].isdo=1;
                       	  }
                       	  else{
                       	  	
                       	  	//this.QuestionList[i].isdo=0;
                       	  }
                       }
                     } 

				},
				SportAmSwitchOn: function(mid,TakeTime) {
					for(var i=0;i<this.SportAmList.length;i++){  
                       if (this.SportAmList[i].PushId==mid){
                       	  if (this.SportAmList[i].isdo==0){
                       	  	this.AnswerSportQuestion('Take',mid,username,i,TakeTime);
                       	  	//this.QuestionList[i].isdo=1;
                       	  }
                       	  else{
                       	  	
                       	  	//this.QuestionList[i].isdo=0;
                       	  }
                       }
                     } 

				},
				SportNmSwitchOn: function(mid,TakeTime) {
					for(var i=0;i<this.SportNmList.length;i++){  
                       if (this.SportNmList[i].PushId==mid){
                       	  if (this.SportNmList[i].isdo==0){
                       	  	this.AnswerSportQuestion('Take',mid,username,i,TakeTime);
                       	  	//this.QuestionList[i].isdo=1;
                       	  }
                       	  else{
                       	  	
                       	  	//this.QuestionList[i].isdo=0;
                       	  }
                       }
                     } 

				},
				SportPmSwitchOn: function(mid,TakeTime) {
					for(var i=0;i<this.SportPmList.length;i++){  
                       if (this.SportPmList[i].PushId==mid){
                       	  if (this.SportPmList[i].isdo==0){
                       	  	this.AnswerSportQuestion('Take',mid,username,i,TakeTime);
                       	  	//this.QuestionList[i].isdo=1;
                       	  }
                       	  else{
                       	  	
                       	  	//this.QuestionList[i].isdo=0;
                       	  }
                       }
                     } 

				},
				SportEmSwitchOn: function(mid,TakeTime) {
					for(var i=0;i<this.SportEmList.length;i++){  
                       if (this.SportEmList[i].PushId==mid){
                       	  if (this.SportEmList[i].isdo==0){
                       	  	this.AnswerSportQuestion('Take',mid,username,i,TakeTime);
                       	  	//this.QuestionList[i].isdo=1;
                       	  }
                       	  else{
                       	  	
                       	  	//this.QuestionList[i].isdo=0;
                       	  }
                       }
                     } 

				},
				SportXmSwitchOn: function(mid,TakeTime) {
					for(var i=0;i<this.SportXmList.length;i++){  
                       if (this.SportXmList[i].PushId==mid){
                       	  if (this.SportXmList[i].isdo==0){
                       	  	this.AnswerSportQuestion('Take',mid,username,i,TakeTime);
                       	  	//this.QuestionList[i].isdo=1;
                       	  }
                       	  else{
                       	  	
                       	  	//this.QuestionList[i].isdo=0;
                       	  }
                       }
                     } 

				},
                  getTaskData: function(UserName) {

						var that = this;
						that.axiosGetLoadding();
						axios.get(domainUrl + 'api/HItemRecord/getInsRecordNewData', {
								params: {
									UserName: UserName
								}
							})
							.then(function(response) {

								if(response.data.code == "200") {


                                    //hui.loading('数据加载中');

									that.SportVal = 85;
									that.FoodVal = response.data.BPLow;
									that.MedVal = response.data.BPPR;
									that.Monitor = response.data.BPPR;

									that.showItemData('Sport', that.SportVal, child1, getColor, getCircle);
//									that.showItemData('Food', that.FoodVal, child2, getColor, getCircle);
									that.showItemData('Med', that.MedVal, child3, getColor, getCircle);
                                    that.showItemData('Monitor', that.MedVal, child4, getColor, getCircle);
                                    that.showItemData('Feel', that.MedVal, child5, getColor, getCircle);
                                    that.showItemData('Edu', that.MedVal, child6, getColor, getCircle);
                                    that.showItemData('Home', that.MedVal, child7, getColor, getCircle);
//                                  that.showItemData('Question', that.MedVal, child8, getColor, getCircle);
                                    that.taskShow=1;
                                    
                                    //hui.loading(false, true);
								}

							})

							.catch(function(response) {
								that.IsShow = 0;
								console.log(response);
							});

					},

				showItemData: function(iType, insVal, circleId, FuncColor, FunCircle) {

						if(insVal != '' && insVal != null && insVal != undefined) {
							var colorVal = FuncColor(iType);
							var maxVal = getCircleMaxValue(iType);

							FunCircle(circleId, insVal, colorVal, maxVal);

						}

					},

				

				axiosGetLoadding: function() {
					axios.interceptors.request.use(function(config) {
						console.log('开始请求')
						config.headers['Content-Type'] = 'application/x-www-form-urlencoded';
						hui.loading('数据加载中');
						return config
					}, function(error) {
						console.log('请求失败')
						hui.closeLoading();
						hui.toast("数据加载失败,请检查网络");
						return Promise.reject(error)
					})
					axios.interceptors.response.use(function(config) {
						hui.closeLoading();

						console.log('接收响应')
						return config
					}, function(error) {
						console.log('响应出错')
						hui.closeLoading();
						hui.toast("数据加载失败,请检查网络");
						return Promise.reject(error)
					})
				},
				CloseDialog: function() {
					this.dialogShow = false;
				},
				ShowDialog: function() {
					if(this.QuestionList.length > 0) {
						this.QuestionContent = this.QuestionList[0].PushContent;
						this.QuestionId = this.QuestionList[0].PushId;
						this.QuestionNum = 1;
						this.dialogShow = true;
					}

				},




				getInRecordInfo: function(UserName) {
					var that = this;
					that.axiosGetLoadding();
					axios.get(domainUrl + 'api/HItemRecord/getUserInsInfo', {
							params: {
								UserName: UserName,
							}
						})
						.then(function(response) {
							if(response.data.code == '200') {
								that.insRecordTips = getDateDiff(getDateTimeStamp(response.data.InsTime)) + "监测过数据";
							} else if(response.data.code == '202') {
								that.insRecordTips = "还没有做过监测哦！";
							} else {
								that.insRecordTips = "获取数据失败,请稍后再试！";
							}

						})
						.catch(function(response) {
							console.log(response);

						});

				},

				GetDayRecordInfo: function(UserName) {
					var that = this;

					that.axiosGetLoadding();
					axios.get(domainUrl + 'api/HealthTask/getUserTaskThDays', {
							params: {
								UserName: UserName
							}
						})
						.then(function(response) {
							if(response.data.SignOnThDays >= 0) {
								that.SignOnTips = '签到第' + response.data.SignOnThDays + '天';
							}
							if(response.data.PushMsgThDays >= 0) {
								that.PushMsgTips = '问答第' + response.data.SignOnThDays + '天';
							}
							if(response.data.FoodThDays >= 0) {
								that.FoodTips = '已记录膳食' + response.data.FoodThDays + '天哦';
							}
							if(response.data.MedThDays >= 0) {
								that.MedTips = '服用记录第' + response.data.MedThDays + '天';
							}
							if(response.data.FeelingThDays >= 0) {
								that.FeelingTips = '心情记录第' + response.data.FeelingThDays + '天';
							}
							if(response.data.SportThDays >= 0) {
								that.SportTips = '运动记录第' + response.data.SportThDays + '天';
							}
							if(response.data.AirHomeTips >= 0) {
								that.AirHomeTips = '生活环境记录第' + response.data.AirHomeThDays + '天';
							}
						})
						.catch(function(response) {
							console.log(response);

						});

				},

				GoAnswerRecord: function() {
					location.href = "PushMsgAnswer.html";
				},
				GoInsTask: function() {
					location.href = "MonitorSet.html?FromUrl=Task";
				},
				GoInsRecord: function() {
					clicked('MemberDataIndex.html', 'MemberDataIndex.html', 'slide-in-left', '健康数据');
				},
				GoFoodRecord: function() {
					clickedNoHead('FoodMyTwitter.html', 'FoodMyTwitter.html', 'zoom-fade-out');	
				},
				GoFoodAdd: function() {
					clicked('DaysFoodRecord.html', 'DaysFoodRecord.html', 'slide-in-left', '膳食日志');
				},
				GoMedRecord: function() {
					clickedNoHead('MedPlanTake.html', 'MedPlanTake.html', 'slide-in-left');	
				},
				GoSleepAdd: function() {
					var parm = {
						"FromType": "Sleep"
					}
					clickedNoHeadParm('SleepSet.html', 'SleepSet.html', 'zoom-fade-out', parm);
				},
				GoRestAdd: function() {
					var parm = {
						"FromType": "Rest"
					}
					clickedNoHeadParm('SleepSet.html', 'SleepSet.html', 'zoom-fade-out', parm);
				},
				GoSleepRecord: function() {
					clickedNoHead('SleepIndex.html', 'SleepIndex.html', 'slide-in-left');	
				},
				GoFeelingAdd: function() {
					clickedNoHead('FeelingIndex.html', 'FeelingIndex.html', 'slide-in-left');	
				},
				GoFeelingRecord: function() {
					clicked('FeelingList.html', 'FeelingList.html', 'slide-in-left', '心情记录');
				},
				GoSportPlan: function() {
					clickedNoHead('SportPlanTake.html', 'SportPlanTake.html', 'slide-in-left');
				},
				GoAirHome: function() {
					clickedNoHead('AirHomeIndex.html', 'AirHomeIndex.html', 'slide-in-left');
				},
				GoAnswer: function() {
					clickedNoHead('../GuideAnswer.html', 'GuideAnswer.html', 'slide-in-left');
				},
				TaskLog: function() {
					clickedNoHead('HealthManageLog.html', 'HealthManageLog.html', 'slide-in-left');
				},
			},
		});






var time_range = function (beginTime, endTime, nowTime) {
  var strb = beginTime.split (":");
  if (strb.length != 2) {
    return false;
  }
 
  var stre = endTime.split (":");
  if (stre.length != 2) {
    return false;
  }
 
  var strn = nowTime.split (":");
  if (stre.length != 2) {
    return false;
  }
  var b = new Date ();
  var e = new Date ();
  var n = new Date ();
 
  b.setHours (strb[0]);
  b.setMinutes (strb[1]);
  e.setHours (stre[0]);
  e.setMinutes (stre[1]);
  n.setHours (strn[0]);
  n.setMinutes (strn[1]);
 
  if (n.getTime () - b.getTime () > 0 && n.getTime () - e.getTime () < 0) {
  	//alert ("当前时间是：" + n.getHours () + ":" + n.getMinutes () + "，在该时间范围内！");
    return true;
  } else {
    //alert ("当前时间是：" + n.getHours () + ":" + n.getMinutes () + "，不在该时间范围内！");
    return false;
  }
}


function getNowFormatDate() {
        var date = new Date();
        var seperator1 = "-";
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var strDate = date.getDate();
        if (month >= 1 && month <= 9) {
            month = "0" + month;
        }
        if (strDate >= 0 && strDate <= 9) {
            strDate = "0" + strDate;
        }
        var currentdate = year + seperator1 + month + seperator1 + strDate;
        return currentdate;
    }

		</script>

	</body>

</html>